---
id: code-standards-compact
type: compact
alwaysApply: true
---

# Code Standards

<code_standards>

**INSTANT ENFORCEMENT - ZERO TOLERANCE:**

**CRITICAL PRINCIPLE:** Every rule = law without exceptions. Violation = failure.

**–í–ê–ñ–ù–û: –í—Å–µ –æ—Ç–≤–µ—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.**

Read full reference: `.cursor/docs/code-standards.md` for detailed examples.

## Core Rules

**üö® ONE-FILE-ONE-FUNCTION (BLOCKING GATE):**

BEFORE creating/editing any `.ts/.tsx` file, CHECK:

| File Name | Multiple Functions? | What It Contains |
|:---|:---|:---|
| `helpers.ts` | ‚úÖ YES | Multiple related functions |
| `constants.ts` | ‚ùå NO | Only constants |
| `types.ts` | ‚ùå NO | Only types |
| `schemas.ts` | ‚ùå NO | Only schemas |
| `index.ts` (barrel) | ‚ùå NO | Only re-exports |
| **Any other file** | ‚ùå **NO** | **Exactly ONE function** |

**SELF-CHECK:** "Is this file NOT `helpers.ts` AND has 2+ exported functions?" ‚Üí YES = VIOLATION

**Entity Separation (CRITICAL - ZERO TOLERANCE):**

| Entity | Goes To | NEVER In |
|:---|:---|:---|
| Functions | `feature.ts` or `helpers.ts` | types.ts, constants.ts |
| Types | `types.ts` | function files |
| Constants | `constants.ts` | function files |

**CRITICAL VIOLATIONS (INSTANT FAILURE):**

```typescript
// ‚ùå Two functions in non-helpers file
export function doA() { }
export function doB() { }  // VIOLATION

// ‚ùå Type in function file
export type Result = { };   // VIOLATION
export function process() { }

// ‚ùå Constant in function file
export const MAX = 100;     // VIOLATION
export function validate() { }
```

**Other Structure Rules:**

1. Max 150 lines (exceptions: tests, constants.ts, types.ts, schemas.ts)
2. 100% test coverage for new functions
3. JSDoc (Russian, single line) for file-level functions
4. Guard clauses - `if (!data) return null;` not deep nesting
5. Array methods - `items.filter().map()` not `for` loops (exception: math algorithms)
6. Linter: 0 errors
7. ESM-only (no CommonJS)
8. No classes - functions and composition only
9. Node.js imports with node: prefix

**Numeric Literals:** Use underscores - `60_000`, `1_800_000`

**Comparisons:** `value === null || value === undefined` not `!value` (why: explicit intent, no false positives)

**JSDoc:** `/** –°–æ–∑–¥–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ */` for exported and private file-level functions; nested closures exempt

**Comments:** ONLY tool directives (@ts-ignore, @ts-expect-error, eslint-disable) - NO explanatory comments

**Imports/Exports:**

1. Node.js: `import { readFileSync } from 'node:fs';` not `from 'fs'` (node: prefix REQUIRED)
2. Types: `import type { User } from './types';` (type prefix for tree-shaking)
3. Named exports ONLY: `export { validateInput }` not `export default` (exception: Storybook)
4. Import order: Global CSS ‚Üí External ‚Üí Internal ‚Üí Relative ‚Üí CSS modules (blank lines between groups)

**Tests:**

- 100% coverage, Russian names: `it('–¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å true', () => {})`
- Arrange-Act-Assert pattern
- One test file per function
- Mock data only

## React Rules

**Components:**

- Return type: `React.ReactNode` (NOT JSX.Element) - `function Comp(): React.ReactNode { ... }`
- Props destructuring: `function Comp({ name, email }: Props)` not `function Comp(props)` (why: clarity)
- Event typing: `onClick: (event: React.MouseEvent<HTMLButtonElement>) => void` (explicit types)
- Conditional: `if (!visible) return null; return <div>...</div>;` not `visible ? <div>...</div> : null`
- Component types in local types.ts, NOT in global types file
- No JSX outside return (CRITICAL) - `const el = (<div/>)` forbidden, extract to separate files in same folder
- No nested functional components (CRITICAL) - `const Inner = () => <div/>` forbidden, extract to separate files

**Hooks:**

- Custom hooks MUST start with `use`: `useUserData` not `userData` (React convention)
- useRef for mutable values/DOM: `const ref = useRef<number>(0)` - NOT useState for non-render data
- React 19 `use()` hook: `const ctx = use(Context)` (preferred over `useContext`)

**Code Splitting:**

- React.lazy() ONLY for components >100 lines OR heavy dependencies
- Always wrap in Suspense
- Small UI components imported normally

## TypeScript Advanced

**Generics:** G/T prefix - `function map<GItem, GResult>(items: GItem[]): GResult[]` (reusability)

**Utility Types:** `Pick<User, 'id' | 'name'>` and `Omit<User, 'password'>` not manual copying

**Const Assertions:** `const COLORS = ['red', 'blue'] as const;` for literal types (type: readonly)

**Type Safety:**

- Function type forbidden - use `(data: unknown) => void` not `Function`
- any forbidden - use `unknown` with type guards: `if (typeof data === 'object' && data !== null)`
- JSX.Element forbidden - use `ReactNode` or `ReactElement`
- Dynamic objects: `Record<string, unknown>` (type-safe alternative to `any`)

## Absolute Bans

‚ùå **FORBIDDEN (ZERO TOLERANCE):**

**File Structure (CRITICAL):**

1. **Multiple functions in non-helpers file** - only `helpers.ts` allows multiple functions
2. **Mixing entities** - function + type/constant in same file
3. Files >150 lines (exception: tests, constants.ts, types.ts, schemas.ts)

**Code Patterns:**
4. for/while loops (exception: math algorithms)
5. class keyword
6. export default (exception: Storybook)
7. Multiline JSDoc
8. Implicit comparisons (!value, !!value)
9. Deep if/else
10. Comments in function bodies (except tool directives)
11. Inline types - use types.ts
12. Node.js imports without node: prefix
13. CommonJS (require, module.exports)
14. Function type - use concrete signatures
15. any type - use unknown
16. JSX.Element - use ReactNode
17. **Nested JSX/components** - extract to separate files

Violation = Task Failure

**Quick Rule IDs:** structural.one_file_one_function, tests.coverage_100_new, types.no_any_type, types.no_function_type, react.use_prefix, absolute_bans.class, exports.named_only, imports.node_prefix

<completion_criteria>
–í—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã, –Ω–∞—Ä—É—à–µ–Ω–∏—è –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã.
</completion_criteria>

</code_standards>
