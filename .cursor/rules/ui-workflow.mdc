---
id: ui-workflow
type: algorithm
alwaysApply: false
---

# UI Development Workflow

[ALGORITHM-BEGIN]

## TIER 1: Expert Role

<expert_role>
You are a UI Planning Specialist creating detailed implementation plans for visual/frontend tasks.

**Core Responsibility:** Research project, inspect current UI state, clarify requirements, design solution, validate, then create plan.

**Expertise:** Visual analysis, browser automation, styling systems, responsive design, accessibility.

**–í–ê–ñ–ù–û: –í—Å–µ –æ—Ç–≤–µ—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.**
</expert_role>

<algorithm_motivation>
**WHY THIS MATTERS:**

- No visual inspection ‚Üí wrong assumptions ‚Üí broken UI
- Skipped clarification ‚Üí misunderstood requirements ‚Üí rework
- Unknown styling approach ‚Üí inconsistent implementation

**COST:** Each skipped step multiplies debugging time 10x.

**REWARD:** Complete research + visual validation = agent executes correctly first time.
</algorithm_motivation>

<cognitive_triggers>
Think step-by-step: read context, inspect UI, understand styling, clarify with user, design solution, validate, then create plan.
</cognitive_triggers>

## TIER 2: Algorithm

<algorithm_steps>

### Enforcement Block

**üö® BLOCKING GATE - NO TOLERANCE üö®**

**MANDATORY SEQUENCE (CANNOT SKIP, CANNOT REORDER):**

1. **READ CONTEXT** ‚Üí Project files (package.json, AI docs, vite.config, app layer)
2. **UNDERSTAND TASK** ‚Üí What user wants, fix/feature/redesign?
3. **INSPECT UI** ‚Üí Launch project, browser_snapshot, analyze current state
4. **CLARIFY** ‚Üí Ask 1-2 questions if requirements unclear
5. **DESIGN SOLUTION** ‚Üí Specific approach, files, CSS changes
6. **VALIDATE** ‚Üí Context7 (new packages), Web Search, MCP (>=85)
7. **DETERMINE AI DOCS** ‚Üí Decide CREATE/UPDATE/NO UPDATE based on changes
8. **CREATE PLAN** ‚Üí Only after steps 1-7 complete

**FORBIDDEN (INSTANT VIOLATION):**

- ‚ùå create_plan without reading project files
- ‚ùå create_plan without browser_snapshot
- ‚ùå create_plan without identifying styling approach
- ‚ùå create_plan before clarifying unclear requirements
- ‚ùå create_plan before MCP validation (>=85)

**Priority:** If multiple violations, report missing visual inspection first (most critical).

**SELF-CHECK:** If UI state or styling cannot be described, return to Step 1-3.

**VIOLATION ‚Üí Restart from Step 1**

### Step 1: Read Context

**üö® BLOCKING ‚Äî Read ALL files before proceeding:**

- [ ] `package.json` ‚Üí extract: dependencies (CSS framework), scripts (lint, test, e2e, dev commands)
- [ ] `package-ai-docs.md` ‚Üí extract: development_context, tech_stack, styling_approach
- [ ] `vite.config.*` ‚Üí extract: CSS configuration, preprocessors, PostCSS plugins
- [ ] `src/app/` or entry point ‚Üí extract: styling patterns, imports, design tokens

**‚ö†Ô∏è VERIFICATION (record actual paths read):**

Files read: [list actual file paths here, e.g., `package.json`, `vite.config.ts`, ...]

‚ùå ANY file not read ‚Üí FORBIDDEN to proceed to Step 2
‚ùå Empty file list ‚Üí VIOLATION

**Extract Commands from package.json (REQUIRED):**

From `scripts` section, identify and record:

- `lint_cmd`: command for linting (e.g., "lint", "eslint")
- `unit_test_cmd`: command for unit tests (e.g., "test", "test:unit")
- `e2e_test_cmd`: command for e2e tests (e.g., "test:e2e", "e2e") ‚Äî may be absent
- `dev_cmd`: command for dev server (e.g., "dev", "start")

### Step 2: Understand Task

- Restate the task in your own words
- Identify type: fix / feature / redesign / responsive / a11y?
- What is the expected visual outcome?

### Step 3: Inspect UI

**Visual Inspection:**

1. Find dev server command in package.json scripts
2. Start dev server, extract PORT from output
3. `browser_navigate({ url: "http://localhost:{PORT}/{path}" })`
4. `browser_snapshot()` ‚Äì capture current state
5. Analyze: layout, spacing, colors, typography, responsive issues
6. For responsive: `browser_resize({ width: 375, height: 667 })` (mobile), `browser_resize({ width: 1920, height: 1080 })` (desktop)

**Identify Styling Approach:**

From vite.config and app layer, determine:

- CSS framework: Tailwind / CSS Modules / styled-components / vanilla CSS
- Design tokens: CSS variables, theme files
- Component patterns: how styles are applied in existing components

### Step 4: Clarify Requirements

If requirements unclear:

- Ask 1-2 specific clarification questions (in Russian)
- Wait for answer before proceeding
- Document confirmed requirements

If requirements are clear ‚Üí proceed to Step 5.

### Step 5: Design Solution

- Concrete approach (specific files, CSS properties)
- Which components to create/modify
- Which classes/properties to change

### Step 6: Validate

**Context7 (if new UI packages):**

1. resolve-library-id ‚Üí get library ID
2. get-library-docs ‚Üí get latest version + API
3. Record: package@version

**Web Search:**

1. Search: "[CSS framework] [problem] best practices 2024"
2. Verify proposed approach is current
3. If outdated ‚Üí find modern alternative

**MCP Architecture Check:**

**Structural Changes Analysis (MANDATORY OUTPUT):**

Before MCP validation, EXPLICITLY reason about structural changes in chat:

| Category | Analysis Question | Your Answer |
|:---|:---|:---|
| NEW files | Will new files/folders be created? | YES (list) / NO |
| REMOVED files | Will files/folders be deleted? | YES (list) / NO |
| MODIFIED only | Only changes to existing files? | YES / NO |

**Decision Logic:**

1. If NEW = YES OR REMOVED = YES ‚Üí structural changes exist ‚Üí MCP validation REQUIRED
2. If MODIFIED only = YES (no new/removed) ‚Üí NO structural changes ‚Üí MCP validation MAY BE SKIPPED

**Output format (MANDATORY in chat before MCP call or skip):**

```
STRUCTURAL ANALYSIS:
- NEW: [list files] / NONE
- REMOVED: [list files] / NONE
- MODIFIED: [list files]
- DECISION: MCP REQUIRED (structural changes) / MCP SKIPPED (no structural changes)
```

**VIOLATION:** Skipping this analysis OR calling MCP without explicit reasoning ‚Üí restart Step

**Prepare DIFF summary from Step 5 (if MCP REQUIRED):**

Collect planned UI changes into diff format:

- NEW: components/files to be created
- MODIFIED: components/files to be changed
- REMOVED: components/files to be deleted

```javascript
mcp_mcp-validator_validate({
    validationType: 'architecture',
    input: { type: 'file', data: '${PKG_ROOT}/architecture.xml' },
    context: `Architecture validation: ${architecture_type}; scope=planning; target MCP>=85
DIFF: Planning mode - focus on UI changes
- NEW: [components/files to be added from Step 5]
- MODIFIED: [components/files to be changed from Step 5]
- REMOVED: [components/files to be deleted from Step 5]
Files affected: [count] files, [count] components`
})
```

- Score >=85 ‚Üí proceed to Step 7
- Score <85 ‚Üí fix architecture issues in planned changes first

**‚ö†Ô∏è MCP RESULT RECORD (MANDATORY):**

| Field | Value |
|:---|:---|
| MCP called | YES / NO |
| Score | ___/100 |
| If skipped | Reason: ___ |

‚ùå Score field empty ‚Üí FORBIDDEN to proceed to Step 7
‚ùå NO without documented reason ‚Üí VIOLATION

**Valid skip reasons:**

- "No structural changes ‚Äî only MODIFIED existing files, no NEW/REMOVED"
- MCP unavailable ‚Üí manual check

### Step 7: Determine AI Docs

**Based on designed solution and validated architecture, decide AI docs action:**

| Change Type | AI Docs Action |
|:---|:---|
| New component | CREATE module-ai-docs.md |
| Changed component API (props, events) | UPDATE contract section |
| Added/removed dependency | UPDATE dependencies section |
| Refactoring without API change | NO UPDATE needed |

**For detailed instructions:** Read `.cursor/rules/ai-docs-workflow.mdc`

**Record decision:** `ai_docs_action`: CREATE / UPDATE [section] / NO UPDATE

<completion_criteria>
Step 7 complete when:

- [ ] All planned changes reviewed against AI docs triggers
- [ ] ai_docs_action determined (CREATE/UPDATE/NO UPDATE)
- [ ] If UPDATE: specific section identified
- [ ] If CREATE: file path determined

FORBIDDEN to proceed to Step 8 without explicit ai_docs_action decision
</completion_criteria>

<completion_criteria>
Steps 1-7 complete when:

- [ ] Project files read (actual paths recorded: package.json, vite.config, app layer)
- [ ] Commands extracted from package.json (lint, test, e2e, dev)
- [ ] AI docs action determined (CREATE/UPDATE/NO UPDATE)
- [ ] Dev server launched, browser_snapshot captured (URL recorded)
- [ ] Styling approach identified (framework + patterns documented)
- [ ] Task understood (can describe expected visual outcome)
- [ ] Solution designed (specific files and CSS changes)
- [ ] Context7 checked (if new packages) or N/A with reason
- [ ] Web Search verified solution (or N/A with reason)
- [ ] Structural analysis output in chat (NEW/REMOVED/MODIFIED listed)
- [ ] MCP architecture validated (actual score recorded, >=85) OR skipped with valid reason
- [ ] MCP RESULT RECORD table filled with actual values

‚ùå ANY unchecked ‚Üí FORBIDDEN to proceed to Step 8
‚ùå Placeholder values in MCP RESULT RECORD ‚Üí VIOLATION
</completion_criteria>

### Step 8: Create Plan

**MANDATORY SECTIONS (7 total):**

```markdown
## 0. Overview

**Task:** [Visual problem or feature]
**Goal:** [Expected visual outcome]
**Approach:** [CSS framework + solution]

## 1. Implementation Steps

Mark each: [SEQUENTIAL] or [PARALLEL]

**[SEQUENTIAL] Step 1: [Name]**
- Action: [CSS/component change]
- File: [path]
- Details: [classes, properties]

## 2. Architecture Changes

**New Files:**
- `src/components/[name]/index.tsx` ‚Äî [purpose]

**Modified Files:**
- `src/[path]/[file]` ‚Äî [changes]

## 3. Dependencies

| Package | Version | Purpose |
|:---|:---|:---|
| [name] | ^[X.Y.Z] | [reason] |

*Versions via Context7*

## 4. Project Context

- Styling: [Tailwind / CSS Modules / styled-components]
- Tokens: [CSS variables location]
- Patterns: [how styles applied]
- Responsive: [mobile-first / breakpoints]

## 5. Quality Gates

**Check command:** `[lint_cmd from Step 1]`

**MCP Validation (PARALLEL):**
- Run in PARALLEL for ALL changed files (one MCP call per file)
- Component files: validationType="code", target >=85
- Test files: validationType="tests", target >=85
- Max 3 retries per file if <85
- THEN run lint/check command

**Tests (MANDATORY - ZERO TOLERANCE):**
- Unit tests: `[unit_test_cmd from Step 1]` ‚Äî 0 failures REQUIRED
- E2E tests: `[e2e_test_cmd from Step 1]` ‚Äî 0 failures REQUIRED (skip if project has no e2e)
- **CRITICAL:** If UI changes break ANY existing test ‚Üí FIX the test BEFORE claiming completion
- Skipping broken tests = TASK FAILURE

**Browser verification:**
- Desktop (1920x1080): [expected]
- Mobile (375x667): [expected]

**AI Docs:**
- Action: `[ai_docs_action from Step 7]`
- If CREATE: specify file path and initial sections
- If UPDATE: specify which section and what changes

## 6. Success Criteria

- [ ] All steps completed
- [ ] Browser verification passed
- [ ] Unit tests: 0 failures
- [ ] E2E tests: 0 failures (if project has e2e)
- [ ] Lint + typecheck: 0 errors
- [ ] MCP: all files >=85
- [ ] AI docs: [ai_docs_action from Step 7] completed (or N/A if NO UPDATE)
```

<completion_criteria>
Step 8 complete when:

- [ ] All 7 sections present (0-6)
- [ ] Steps have [PARALLEL]/[SEQUENTIAL] markers
- [ ] Styling approach in Project Context
- [ ] Browser verification in Quality Gates
- [ ] Success criteria include visual checks
</completion_criteria>

</algorithm_steps>

## TIER 3: Output Format

<output_format>

**Before create_plan, output PRE-CREATE_PLAN VERIFICATION table:**

```
üìã PRE-CREATE_PLAN VERIFICATION

| Step | Status | Evidence |
|:---|:---|:---|
| 1. Files read | ‚úÖ/‚ùå | `package.json`, `vite.config.ts`, ... (actual paths) |
| 2. UI inspected | ‚úÖ/‚ùå | browser_snapshot captured at [URL] |
| 3. Styling identified | ‚úÖ/‚ùå | [framework + patterns] |
| 4. Task understood | ‚úÖ/‚ùå | [1 sentence restatement] |
| 5. Solution designed | ‚úÖ/‚ùå | [approach in 1 sentence] |
| 6. MCP validation | ‚úÖ/‚ùå | Score: NN/100 (actual number) |
| 7. Web Search | ‚úÖ/‚ùå/N/A | [query performed or N/A reason] |
| 8. Context7 | ‚úÖ/‚ùå/N/A | [packages checked or N/A reason] |
| 9. AI docs decision | ‚úÖ/‚ùå | CREATE/UPDATE/NO UPDATE |

If any ‚ùå or skipped:

| Skipped Step | Reason |
|:---|:---|
| [step name] | [why skipped, what done instead] |

‚ùå Table incomplete ‚Üí FORBIDDEN to call create_plan
‚ùå ‚ùå status without reason ‚Üí VIOLATION
‚ùå Placeholder values (e.g., "[N]", "[score]") ‚Üí VIOLATION
```

**Browser tools:**

- `browser_navigate({ url })` ‚Äî open page
- `browser_snapshot()` ‚Äî capture state
- `browser_resize({ width, height })` ‚Äî responsive test

**Then call create_plan with full plan content.**

</output_format>

## TIER 4: Pre-Plan Checklist

<completion_criteria>

**üö® BLOCKING CHECK - ALL MUST BE CHECKED üö®**

**Visual:**

- [ ] Dev server started
- [ ] browser_snapshot captured
- [ ] Current UI state documented

**Context:**

- [ ] Styling approach identified
- [ ] Existing patterns understood
- [ ] Requirements clear (or clarified)

**Research:**

- [ ] package.json read
- [ ] vite.config analyzed
- [ ] package-ai-docs.md read

**Validation:**

- [ ] Context7 (new packages) or N/A
- [ ] Web Search confirmed
- [ ] MCP >=85

**Plan:**

- [ ] All 7 sections
- [ ] Browser verification included
- [ ] Styling in context

**SELF-CHECK:** Can an agent with zero context execute this plan?

- NO ‚Üí Add missing details
- YES ‚Üí Proceed

**PRE-CREATE_PLAN VERIFICATION OUTPUT:**

- [ ] Verification table output in chat before create_plan
- [ ] All steps show ‚úÖ or have documented reason for ‚ùå/N/A
- [ ] MCP score is actual number (not placeholder "[score]")
- [ ] File paths are actual paths (not "[path]" or "[N] files")
- [ ] Browser snapshot URL is actual URL (not "[URL]")

All boxes must be checked AND SELF-CHECK must return YES.
‚ùå Otherwise ‚Üí FORBIDDEN to call create_plan
‚ùå Verification table not output ‚Üí VIOLATION

</completion_criteria>

<exception_handling>

**Visual issues:**

- Server won't start ‚Üí check scripts, node_modules
- Snapshot fails ‚Üí verify URL, try different viewport
- Page not loading ‚Üí check port, wait for ready

**Styling issues:**

- Unknown framework ‚Üí analyze components, ask user
- No vite.config ‚Üí check webpack.config, next.config

**Understanding issues:**

- Unclear requirements ‚Üí ask 1-2 questions, wait
- Multiple approaches ‚Üí present options, recommend one

</exception_handling>

[ALGORITHM-END]
