---
id: 07-agent-mode-workflow
type: compact
alwaysApply: true
---

# Agent Mode Workflow

<agent_mode_workflow>

**EXECUTE:** Apply ONLY if system_reminder contains "Agent mode" or no mode specified. If Plan Mode (priority) / Ask Mode / other ‚Üí skip.

**ZERO TOLERANCE - MANDATORY EXECUTION:**

**–í–ê–ñ–ù–û: –í—Å–µ –æ—Ç–≤–µ—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.**

**NOTE:** Mode announcement handled by `.cursor/rules/01-chat-mode-router.mdc`. If plan exists ‚Üí follow todos.

**üö® DOCS (MANDATORY - read BEFORE modify):**

**Triggers (check before modify, read if needed):**

**BLOCKING:** FORBIDDEN to modify file until required docs read.

- ANY `.md/.mdc` ‚Üí `.cursor/rules/prompt-structure-guide.mdc`
- `*.test.ts` ‚Üí `.cursor/rules/testing.md`
- New `.ts/.tsx` ‚Üí `.cursor/rules/architecture.md`, `.cursor/rules/naming.md`
- Edit `.ts/.tsx` (‚â•20 lines) ‚Üí `.cursor/rules/code-standards.md`, `.cursor/rules/naming.md`
- AI docs ‚Üí `.cursor/rules/ai-docs-workflow.mdc`

**Exceptions:** README.md, CHANGELOG.md, `*.config.ts`

**Self-check:** Before editing `.md/.mdc` ‚Üí inspect YAML ‚Üí if `type:` exists ‚Üí prompt file ‚Üí trigger applies

**EXTERNAL:**

1. Context7: Before package ‚Üí resolve-library-id + get-library-docs
2. Web Search: Error persists 2+ attempts ‚Üí search ‚Üí retry

**TESTS:**

- Unit: All `.ts/.tsx` need tests in `__tests__/` (except `*.types.ts`, `*.constants.ts`, `*.schema.ts`)
- E2E: New/modified features ‚Üí e2e test in `src/__tests__/e2e/` with mock data

**üö® VALIDATION (MANDATORY after EACH modification - BLOCKING):**

**REQUIRED for:**

- `.ts/.tsx` ‚Üí `code`
- `*.test.ts` ‚Üí `tests`
- `.mdc/.md` ‚Üí `prompts`
- `architecture.xml` ‚Üí `architecture`
- AI docs ‚Üí `documentation`

**SKIP:** README.md, CHANGELOG.md, `*.config.ts`, `package.json`, `tsconfig.json`

**Steps:**

1. Call MCP with absolute path + type
2. Target ‚â•85 | If <85 ‚Üí fix, retry (max 3x)
3. Report: `[OK] File: [name] | Score: [X]/100 | PASSED ‚úì`

**ANTI-PATTERN:** search_replace ‚Üí lint (‚ùå) | **CORRECT:** search_replace ‚Üí MCP ‚Üí lint (‚úì)

**Pre-response:** [ ] All validated? [ ] All ‚â•85? ‚ùå ‚Üí STOP

**BLOCKING:** FORBIDDEN to respond until all files validated (‚â•85). Incomplete validation = STOP.

3 failures ‚Üí escalate.

**WORKFLOW:**

1. Check plan ‚Üí follow todos
2. Check triggers ‚Üí read docs
3. External deps ‚Üí Context7/web search
4. Execute ‚Üí functional style, unit tests
5. Validate EACH ‚Üí MCP (‚â•85)
6. E2E tests ‚Üí new/modified features with mocks
7. Final ‚Üí run `yarn lint` (if no such command ‚Üí check `package.json` scripts for available checks) (0 errors REQUIRED)
8. AI docs ‚Üí MANDATORY update if code/architecture changed (read `.cursor/rules/ai-docs-workflow.mdc`)
9. Report ‚Üí files with scores

**PRE-RESPONSE BARRIER:**

BEFORE responding verify ALL:

- [ ] Required docs read (if triggers matched)
- [ ] All files validated via MCP (‚â•85)
- [ ] Unit tests written/updated
- [ ] E2E tests for new features
- [ ] Lint/type/test: 0 errors
- [ ] AI docs updated (if code changed)

‚ùå ANY unchecked ‚Üí FORBIDDEN to respond | ‚úì ALL checked ‚Üí proceed

**FALLBACKS:** MCP unavailable ‚Üí lint/type/test | Validation <85 ‚Üí iterate 3x | Unclear ‚Üí ask

**MANDATORY GATE (ZERO EXCEPTIONS):**

<completion_criteria>
All validated (‚â•85), e2e tests pass, lint/type/test: 0 errors, todos done.

Format: `[OK] Modified [N] | Validated [N] | ‚â•85: YES | E2E: PASS | Errors: 0 | COMPLETE`
</completion_criteria>

</agent_mode_workflow>
